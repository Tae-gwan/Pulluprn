# Playwright 전용 Dockerfile (Ubuntu 기반)
FROM mcr.microsoft.com/playwright:v1.58.2-jammy

WORKDIR /app

# 루트의 package.json 복사 (server 폴더 내용 포함)
# 하지만 여기선 server/ 폴더만 필요하므로
COPY server/package*.json ./

# 의존성 설치 (Playwright 브라우저 포함)
RUN npm install

# 소스 코드 복사
COPY server/ .
COPY prisma ./prisma/

# Prisma Client 생성
RUN npx prisma generate --schema=./prisma/schema.prisma

EXPOSE 3003

CMD ["node", "browser.js"]
